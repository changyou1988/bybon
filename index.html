<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> 故障排查系统 </title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #121212;
            color: #e0e0e0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }

        .container {
            background-color: #1e1e1e;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            width: 400px; /* 增加容器宽度 */
            text-align: center;
        }

        h1 {
            color: #00bfff;
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            text-align: left;
        }

        input[type="password"] {
            width: 100%;
            padding: 10px;
            margin-bottom: 20px;
            border: none;
            border-radius: 5px;
            background-color: #2b2b2b;
            color: #e0e0e0;
        }

        select {
            width: 100%; /* 设置下拉菜单宽度为100% */
            padding: 10px;
            margin-bottom: 20px;
            border: none;
            border-radius: 5px;
            background-color: #2b2b2b;
            color: #e0e0e0;
            font-size: 16px; /* 增加字体大小 */
        }

        button {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 5px;
            background-color: #00bfff;
            color: #121212;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-size: 16px; /* 增加按钮字体大小 */
        }

        button:hover {
            background-color: #009acd;
        }

        #menu {
            display: none;
            margin-top: 20px;
        }

        #menu button {
            margin-top: 10px;
        }

        /* 添加新样式，设置按钮之间的间隙和颜色区分 */
        #steps button {
            margin-top: 10px;
        }

        #steps button:nth-child(1) {
            background-color: #00bfff;
        }

        #steps button:nth-child(1):hover {
            background-color: #009acd;
        }

        #steps button:nth-child(2) {
            background-color: #ff6347; /* 使用不同的颜色，这里选择了番茄红 */
        }

        #steps button:nth-child(2):hover {
            background-color: #e5543c;
        }
    </style>

    <!-- 引入 axios 库 -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <!-- 引入 SweetAlert2 库 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.all.min.js"></script>
</head>
<body>
    <!-- 登录表单 -->
    <div id="loginForm" class="container">
        <h1>故障排查系统</h1>
        <label for="password">密码:</label>
        <input type="password" id="password">
        <button onclick="login()">登录</button>
    </div>
    <!-- 故障排查系统内容，初始隐藏 -->
    <div id="troubleshootingSystem" class="container" style="display: none;">
        <h1>故障排查系统</h1>
        <p>请选择您遇到的问题类型：</p>
        <select id="problemType">
            <option value="powerOn">不开机问题</option>
            <option value="shortBattery">待机时间短</option>
            <option value="poorSignal">信号差</option>
            <option value="stillProblem">维修后仍旧有问题</option>
            <option value="shuaihuai">屏幕破裂</option>
            <option value="kadun">手机卡顿</option> 
            <option value="tingtong">听筒声音小</option>
            <option value="blindModeExit">盲人模式退出问题</option>
        </select>
        <button onclick="startTroubleshooting()">开始排查</button>
        <div id="steps" style="display: none;">
            <p id="stepText"></p>
            <button onclick="nextStep()">下一步</button>
            <button onclick="restartTroubleshooting()">重新选择问题</button>
        </div>
        <div id="menu">
            <button onclick="goBackToInitialPage()">返回主菜单</button>
            <button onclick="logout()">退出登录</button>
        </div>
    </div>

    <!-- 盲人模式退出引导，初始隐藏 -->
    <div id="blindModeExitGuide" style="display: none;">
        <!-- 复制盲人模式退出方法.html 的内容 -->
        <div id="step1" class="step" style="display: none;">
            <div class="step-content">
                <div class="emoji">👆</div>
                <h2>尝试通过侧边按键退出盲人模式</h2>
                <div class="progress-bar">
                    <div class="progress" style="width: 25%"></div>
                </div>
                <button onclick="showConfirm(1)">我已连续点击侧边按键3次</button>
            </div>
        </div>

        <div id="step2" class="step" style="display: none;">
            <div class="step-content">
                <div class="emoji">📱</div>
                <h2>检查屏幕亮屏状态及响应</h2>
                <div class="progress-bar">
                    <div class="progress" style="width: 50%"></div>
                </div>
                <button onclick="checkScreenLit()">我已点击开机键</button>
            </div>
        </div>

        <div id="step3" class="step" style="display: none;">
            <div class="step-content">
                <div class="emoji">👂</div>
                <h2>如果屏幕不亮请执行</h2>
                <div class="progress-bar">
                    <div class="progress" style="width: 75%"></div>
                </div>
                <div id="promptCheck">
                    <p class="warning">请持续点击开机键直到听到提示音（如报时或通知内容）</p>
                    <button onclick="checkPromptSound()">我听到提示音了</button>
                </div>
                <div id="unlockGuide" style="display:none;">
                    <p>请用三指连续敲击屏幕直至屏幕亮起</p>
                    <button onclick="activateScreen()">屏幕已亮起</button>
                </div>
            </div>
        </div>

        <div id="step4" class="step" style="display: none;">
            <div class="step-content">
                <div class="emoji">📞</div>
                <h2>寻求技术支持</h2>
                <div class="progress-bar">
                    <div class="progress" style="width: 100%"></div>
                </div>
                <p>建议联系技术支持或专业人员获取帮助，联系方式：[具体联系方式]</p>
                <button onclick="askRetry()">是否需要再次尝试上述步骤？</button>
            </div>
        </div>

        <div id="resetDiv" style="display: none;">
            <button onclick="resetProcess()">重新开始</button>
        </div>
    </div>

    <script>
        // 硬编码的密码，只能在源代码里修改
        const HARDCODED_PASSWORD = '8888';

        // 页面加载时清理历史记录
        window.onload = function() {
            localStorage.clear();
            sessionStorage.clear();
            document.getElementById('password').value = '';
        };

        // 登录函数
        function login() {
            const password = document.getElementById('password').value;
            // 清空密码输入框，避免旧密码残留
            document.getElementById('password').value = ''; 

            if (password === HARDCODED_PASSWORD) {
                document.getElementById('loginForm').style.display = 'none';
                document.getElementById('troubleshootingSystem').style.display = 'block';
            } else {
                alert('密码错误，请重试。');
            }
        }

        // 退出登录函数
        function logout() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('troubleshootingSystem').style.display = 'none';
            document.getElementById('steps').style.display = 'none';
            document.getElementById('menu').style.display = 'none';
            document.getElementById('blindModeExitGuide').style.display = 'none';
            document.getElementById('password').value = ''; // 清空密码输入框
        }

        // 初始步骤数组
        let currentStep = 0;
        let problemSteps = [];

        function startTroubleshooting() {
            const problemType = document.getElementById('problemType').value;
            document.getElementById('steps').style.display = 'none';
            document.getElementById('blindModeExitGuide').style.display = 'none';

            switch (problemType) {
                case 'powerOn':
                case 'shortBattery':
                case 'poorSignal':
                case 'stillProblem':
                case 'shuaihuai':
                    problemSteps = getStepsForProblem(problemType);
                    currentStep = 0;
                    showStep();
                    document.getElementById('steps').style.display = 'block';
                    document.getElementById('troubleshootingSystem').querySelector('#menu').style.display = 'block';
                    break;
                case 'blindModeExit':
                    document.getElementById('troubleshootingSystem').style.display = 'none';
                    document.getElementById('blindModeExitGuide').style.display = 'block';
                    currentStepBlindMode = 1; // 确保每次进入都从第一步开始
                    showStepBlindMode();
                    break;
            }
        }

        function getStepsForProblem(problemType) {
            const STEPS = {
                powerOn: [
                    '确认手机电池是否有电，建议您尝试充电一段时间后再尝试开机。',
                    '请按照您手机机型正确的强制重启步骤操作（不同品牌和型号的手机可能有所不同）。',
                    '请确保使用的充电设备是原装或认证的，并且工作正常。',
                    '如果以上步骤都无法解决问题，可能是系统问题，建议您尝试进入恢复模式进行系统修复或恢复出厂设置（注意提醒备份数据）。'
                ],
                shortBattery: [
                    '请问您是否经常使用大量应用，尤其是那些在后台持续运行的应用程序？',
                    '请通过手机内置的电池健康功能查看电池状态，判断是否需要更换电池。',
                    '有时待机时间短可能是由于软件问题引起的，确保系统和应用程序都是最新版本。',
                    '建议您开启省电模式或者调整屏幕亮度、自动锁屏时间等设置来延长电池寿命。'
                ],
                poorSignal: [
                    '请问您所在的位置是否有信号覆盖的问题，比如地下室、偏远山区等？',
                    '建议您开启并关闭飞行模式以重新搜索网络信号。',
                    '请检查SIM卡是否安装正确，必要时可尝试重新插拔或更换SIM卡。',
                    '若上述方法均无效，可能存在硬件问题，如天线损坏等，需进一步专业检测。'
                ],
                stillProblem: [
                    '请详细描述之前维修的具体内容，包括更换了哪些部件以及进行了何种修理。',
                    '请根据您的描述重现问题，确认具体的表现形式。',
                    '如果客服无法解决，我们会及时将信息反馈给技术支持团队做深入分析。'
                ],
                shuaihuai: [
                    '检查手机是否有明显的物理损伤，例如裂纹或凹陷。',
                    '尝试重启手机，有时候简单的重启可以解决问题。',
                    '如果手机进水或受潮，请立即关机并干燥处理，避免进一步损害。',
                    '如果以上步骤都无法解决问题，建议联系专业的维修服务。'
                ]
            };
            return STEPS[problemType];
        }

        function showStep() {
            const stepText = document.getElementById('stepText');
            stepText.textContent = `步骤 ${currentStep + 1}: ${problemSteps[currentStep]}`;
        }

        function nextStep() {
            if (currentStep < problemSteps.length - 1) {
                currentStep++;
                showStep();
            } else {
                alert('故障排查已完成。如果问题仍然存在，请联系我们的技术支持团队。');
                restartTroubleshooting();
            }
        }

        function restartTroubleshooting() {
            currentStep = 0;
            problemSteps = [];
            hideElement('steps');
            hideElement('menu');
        }

        // 返回用户登录后的最初界面
        function goBackToInitialPage() {
            hideElement('steps');
            hideElement('menu');
        }

        // 支持使用 Enter 键登录
        document.getElementById('password').addEventListener('keydown', function (event) {
            if (event.key === 'Enter') {
                login();
            }
        });

        // 盲人模式退出引导相关函数
        let currentStepBlindMode = 1;

        async function showConfirm(branch) {
            try {
                const { isConfirmed } = await Swal.fire({
                    title: '是否已退出盲人模式？',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonText: '是',
                    cancelButtonText: '否',
                    width: 600, // 调整弹窗宽度
                    padding: '3em', // 调整内边距
                    allowOutsideClick: false // 禁止点击外部关闭弹窗
                });
                if (isConfirmed) {
                    exitFlow();
                } else {
                    currentStepBlindMode = getNextStep(branch);
                    showStepBlindMode();
                }
            } catch (error) {
                console.error('SweetAlert2 出现错误:', error);
                alert('出现错误，请稍后重试。');
            }
        }

        async function checkScreenLit() {
            try {
                const { isConfirmed } = await Swal.fire({
                    title: '屏幕是否亮起？',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonText: '是',
                    cancelButtonText: '否',
                    width: 600,
                    padding: '3em',
                    allowOutsideClick: false
                });
                if (isConfirmed) {
                    await Swal.fire({
                        title: '请单指滑动进入解锁页面，输入密码时每个数字需要双击',
                        icon: 'info',
                        width: 600,
                        padding: '3em',
                        allowOutsideClick: false
                    });
                    const { isConfirmed: exited } = await Swal.fire({
                        title: '是否已退出盲人模式？',
                        icon: 'question',
                        showCancelButton: true,
                        confirmButtonText: '是',
                        cancelButtonText: '否',
                        width: 600,
                        padding: '3em',
                        allowOutsideClick: false
                    });
                    if (exited) {
                        exitFlow();
                    } else {
                        currentStepBlindMode = 1;
                        showStepBlindMode();
                    }
                } else {
                    currentStepBlindMode = 3;
                    showStepBlindMode();
                }
            } catch (error) {
                console.error('SweetAlert2 出现错误:', error);
                alert('出现错误，请稍后重试。');
            }
        }

        function checkPromptSound() {
            hideElement('promptCheck');
            showElement('unlockGuide');
        }

        async function activateScreen() {
            try {
                await Swal.fire({
                    title: '屏幕已亮起，请单指滑动进入解锁页面，输入密码时每个数字需要双击',
                    icon: 'info',
                    width: 600,
                    padding: '3em',
                    allowOutsideClick: false
                });
                const { isConfirmed: exited } = await Swal.fire({
                    title: '是否已退出盲人模式？',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonText: '是',
                    cancelButtonText: '否',
                    width: 600,
                    padding: '3em',
                    allowOutsideClick: false
                });
                if (exited) {
                    exitFlow();
                } else {
                    currentStepBlindMode = 3;
                    showStepBlindMode();
                    showElement('promptCheck');
                    hideElement('unlockGuide');
                }
            } catch (error) {
                console.error('SweetAlert2 出现错误:', error);
                alert('出现错误，请稍后重试。');
            }
        }

        async function askRetry() {
            try {
                const { isConfirmed } = await Swal.fire({
                    title: '是否需要再次尝试上述步骤？',
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonText: '是',
                    cancelButtonText: '否',
                    width: 600,
                    padding: '3em',
                    allowOutsideClick: false
                });
                if (isConfirmed) {
                    currentStepBlindMode = 1;
                    showStepBlindMode();
                } else {
                    exitFlow();
                }
            } catch (error) {
                console.error('SweetAlert2 出现错误:', error);
                alert('出现错误，请稍后重试。');
            }
        }

        // 在showStep函数中添加进度条更新
        function showStepBlindMode(stepNumber) {
            if (!stepNumber) {
                stepNumber = currentStepBlindMode;
            }
            const steps = document.querySelectorAll('#blindModeExitGuide .step');
            hideElements(steps);
            const step = document.getElementById(`step${stepNumber}`);
            showElement(step);

            // 更新进度条
            const progress = step.querySelector('.progress');
            progress.style.width = `${stepNumber * 25}%`;
        }

        function exitFlow() {
            try {
                Swal.fire({
                    title: '操作完成！如问题仍未解决，请保持与技术支持的联系',
                    icon: 'success',
                    showCancelButton: true,
                    confirmButtonText: '重新开始',
                    cancelButtonText: '回到主菜单',
                    width: 600,
                    padding: '3em',
                    allowOutsideClick: false
                }).then((result) => {
                    if (result.isConfirmed) {
                        resetProcess();
                    } else {
                        goBackToTroubleshooting();
                    }
                });
                const steps = document.querySelectorAll('#blindModeExitGuide .step');
                hideElements(steps);
                hideElement('resetDiv');
            } catch (error) {
                console.error('SweetAlert2 出现错误:', error);
                alert('出现错误，请稍后重试。');
            }
        }

        function goBackToTroubleshooting() {
            hideElement('blindModeExitGuide');
            showElement('troubleshootingSystem');
        }

        function resetProcess() {
            currentStepBlindMode = 1;
            const steps = document.querySelectorAll('#blindModeExitGuide .step');
            hideElements(steps);
            showElement('step1');
            showElement('promptCheck');
            hideElement('unlockGuide');
            hideElement('resetDiv');
        }

        // 辅助函数：隐藏元素
        function hideElement(elementIdOrElement) {
            const element = typeof elementIdOrElement === 'string' ? document.getElementById(elementIdOrElement) : elementIdOrElement;
            if (element) {
                element.style.display = 'none';
            }
        }

        // 辅助函数：显示元素
        function showElement(elementIdOrElement) {
            const element = typeof elementIdOrElement === 'string' ? document.getElementById(elementIdOrElement) : elementIdOrElement;
            if (element) {
                element.style.display = 'block';
            }
        }

        // 辅助函数：隐藏多个元素
        function hideElements(elements) {
            elements.forEach(element => {
                element.style.display = 'none';
            });
        }

        // 辅助函数：获取下一步步骤
        function getNextStep(branch) {
            switch(branch) {
                case 1:
                    return 2;
                case 2:
                    return 3;
                case 3:
                    return 4;
                default:
                    return 1;
            }
        }
    </script>
</body>
<div style="position: fixed; bottom: 10px; right: 10px; color: #e0e0e0;">作者：康鹏飞</div>
</html>
